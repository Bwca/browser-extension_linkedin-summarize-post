<div class="settings-container">
  <div class="header">
    <a routerLink="/" class="back-btn">‚Üê Back</a>
    <h1>AI Settings</h1>
  </div>

  <form (ngSubmit)="onSave()" class="settings-form">
    <div class="form-group">
      <label for="temperature">
        Temperature
        <span class="help-text">Controls randomness (0.0 - 1.0)</span>
      </label>
      <div class="input-group">
        <input
          type="range"
          id="temperature"
          name="temperature"
          min="0"
          max="1"
          step="0.1"
          [(ngModel)]="temperature"
          (input)="onTemperatureChange()"
        />
        <span class="value-display">{{ temperature.toFixed(1) }}</span>
      </div>
      <p class="description">
        Higher values (0.8-1.0) make output more creative and varied. Lower values (0.0-0.3)
        make it more focused and deterministic.
      </p>
    </div>

    <div class="form-group">
      <label for="topK">
        Top K
        <span class="help-text">Limits vocabulary selection</span>
      </label>
      <div class="input-group">
        <input
          type="range"
          id="topK"
          name="topK"
          min="1"
          max="10"
          step="1"
          [(ngModel)]="topK"
          (input)="onTopKChange()"
        />
        <span class="value-display">{{ topK }}</span>
      </div>
      <p class="description">
        Lower values (1-3) make output more focused. Higher values (8-10) allow more diverse
        vocabulary.
      </p>
    </div>

    <div class="form-group">
      <label for="systemPrompt">
        System Prompt
        <span class="help-text">Instructions for the AI</span>
      </label>
      <textarea
        id="systemPrompt"
        name="systemPrompt"
        [(ngModel)]="systemPrompt"
        rows="15"
        class="prompt-textarea"
      ></textarea>
      <button type="button" class="btn-link" (click)="resetPromptToDefault()">
        Reset prompt to default
      </button>
      <p class="description">
        Customize how the AI analyzes LinkedIn posts. Changes take effect after saving.
      </p>
    </div>

    <div class="form-actions">
      <button type="submit" class="btn btn-primary" [disabled]="saving()">
        {{ saving() ? 'Saving...' : 'Save Settings' }}
      </button>
      <button type="button" class="btn btn-secondary" (click)="confirmReset()" [disabled]="saving() || isUsingDefaults">
        Reset to Defaults
      </button>
    </div>

    @if (isUsingDefaults) {
    <div class="info-message">
      ‚ÑπÔ∏è You are using default settings
    </div>
    }

    @if (showResetConfirm()) {
    <div class="confirm-dialog">
      <div class="confirm-content">
        <h3>‚ö†Ô∏è Reset to Defaults?</h3>
        <p>This will restore all settings (temperature, topK, and system prompt) to their default values. This action cannot be undone.</p>
        <div class="confirm-actions">
          <button type="button" class="btn btn-danger" (click)="onReset()" [disabled]="saving()">
            Yes, Reset Everything
          </button>
          <button type="button" class="btn btn-secondary" (click)="cancelReset()" [disabled]="saving()">
            Cancel
          </button>
        </div>
      </div>
    </div>
    }

    @if (message()) {
    <div class="message" [class.error]="isError()">
      {{ message() }}
    </div>
    }
  </form>

  <div class="info-box">
    <h3>üí° Tips</h3>
    <ul>
      <li>
        <strong>Temperature 0.8 + Top K 3</strong> (default): Balanced, consistent analysis
      </li>
      <li><strong>Temperature 0.3 + Top K 1</strong>: Very consistent, predictable results</li>
      <li><strong>Temperature 1.0 + Top K 8</strong>: More creative, varied summaries</li>
    </ul>
  </div>
</div>

